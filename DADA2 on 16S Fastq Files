#Before starting, make sure to unzip the fastq files. Can use gzip -d command on terminal to do this
library(dada2)
path <- "~/Fastq")
#The list files command should list all the paired end reads for each sample.
list.files(path)

# Forward and reverse fastq filenames have format: SAMPLENAME_R1_001.fastq and SAMPLENAME_R2_001.fastq
fnFs <- sort(list.files(path, pattern="_R1_001.fastq", full.names = TRUE))
fnRs <- sort(list.files(path, pattern="_R2_001.fastq", full.names = TRUE))
# Extract sample names, assuming filenames have format: SAMPLENAME_XXX.fastq
sample.names <- sapply(strsplit(basename(fnFs), "_"), `[`, 1)

#Plot the Read Quality for the forward and reverse paired end reads and put them in separate PDFs
pdf(file = "~/Fastq/Read_Quality_Profiles_FWD.pdf")
plotQualityProfile(fnFs[1:8])
plotQualityProfile(fnFs[9:16])
plotQualityProfile(fnFs[17:24])
plotQualityProfile(fnFs[25:32])
plotQualityProfile(fnFs[33:40])
plotQualityProfile(fnFs[41:48])
plotQualityProfile(fnFs[49:56])
plotQualityProfile(fnFs[57:64])
plotQualityProfile(fnFs[65:72]).
dev.off()
pdf(file = "~/Fastq/Read_Quality_Profiles_REV.pdf")
plotQualityProfile(fnRs[1:8])
plotQualityProfile(fnRs[9:16])
plotQualityProfile(fnRs[17:24])
plotQualityProfile(fnRs[25:32])
plotQualityProfile(fnRs[33:40])
plotQualityProfile(fnRs[41:48])
plotQualityProfile(fnRs[49:56])
plotQualityProfile(fnRs[57:64])
plotQualityProfile(fnRs[65:72]).
dev.off()
